<!DOCTYPE html>
<html class="light">
<head>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>
<meta charset="UTF-8">
  <title>DefCost 3.0.11</title>
  <link rel="stylesheet" href="./css/style.css">
</head>
<body class="app">
        <h1 class="title">DefCost 3.0.11</h1>
<button id="darkModeToggle" class="btn ghost">Toggle Dark Mode</button>
<div id="quoteBuilderMain" class="panel grid" aria-label="Quote Builder" role="region">
  <div id="quoteHeader" class="header">
    <div class="quote-header-left">
      <h2 id="qbTitle" class="title">Quote Builder</h2>
      <span id="toast" class="badge"></span>
    </div>
    <div id="quoteActions" class="toolbar">
      <button id="clearQuoteBtn" class="btn danger" type="button" aria-label="Delete quote">Delete quote</button>
      <button id="addCustomBtn" class="btn ghost" type="button">Add custom line</button>
      <button id="addSectionBtn" class="btn primary" type="button">+ Section</button>
      <button id="importCsvBtn" class="btn ghost" type="button">Import CSV</button>
      <button id="exportCsvBtn" class="btn primary" type="button">Export quote CSV</button>
      <input id="importCsvInput" type="file" accept=".csv" style="display:none">
    </div>
  </div>
  <div id="sectionTabsBar" class="panel tabs-panel">
    <div id="sectionTabs" class="tabs"></div>
  </div>
  <div id="basketContainer" class="panel basket-panel">
    <div id="basketSticky">
      <div id="basketStickyHead">
        <table id="basketHead" class="table">
          <colgroup>
            <col style="width:36px">
            <col style="width:200px">
            <col id="col-item">
            <col style="width:120px">
            <col style="width:110px">
            <col style="width:140px">
            <col style="width:50px">
          </colgroup>
          <thead><tr>
            <th class="sort-handle">≡</th><th>Section</th><th>Item</th><th>Quantity</th>
            <th>Price</th>
            <th>Line Total</th><th></th>
          </tr></thead>
        </table>
      </div>
    </div>
    <div id="basketContent">
      <div class="basket-table-area">
      <table id="basketTable" class="table">
        <colgroup>
          <col style="width:36px">
          <col style="width:200px">
          <col id="col-item">
          <col style="width:120px">
          <col style="width:110px">
          <col style="width:140px">
          <col style="width:50px">
        </colgroup>
          <thead><tr>
            <th class="sort-handle">≡</th><th>Section</th><th>Item</th><th>Quantity</th>
            <th>Price</th>
            <th>Line Total</th><th></th>
          </tr></thead>
        <tbody></tbody><tfoot></tfoot>
      </table>
      </div>
    </div>
  </div>
  <div class="grand-totals-wrapper">
    <aside id="grandTotals" class="card" aria-live="polite"></aside>
  </div>
</div>
<div id="catalogWindow" class="catalogue panel" aria-label="Catalogue window" role="dialog" aria-modal="false">
  <div id="catalogTitlebar" class="titlebar">
    <div id="catalogDots" class="dots">
      <button id="catalogClose" class="dot red" aria-label="Hide catalogue" title="Hide catalogue"></button>
      <button id="catalogMin" class="dot yellow" aria-label="Dock window" title="Dock window"></button>
      <button id="catalogZoom" class="dot green" aria-label="Full screen" title="Full screen"></button>
    </div>
    <div id="catalogTitle" class="title">Catalogue</div>
  </div>
  <div id="catalogBody" class="catalogue-body">
    <div id="sheetTabs" class="tabs"></div>
    <div id="status" style="margin:.5rem 0;font-size:.9rem"></div>
    <div id="manualLoad" style="display:none;margin:.5rem 0"><label class="search-label">Load workbook:</label><input type="file" id="xlsxPicker" accept=".xlsx"></div>
    <div id="sheetContainer"></div>
  </div>
  <div id="catalogResizeHandle" aria-hidden="true"></div>
</div>
<button id="catalogDockIcon" class="btn primary" title="Open catalogue" aria-label="Open catalogue">Catalogue</button>
<script src="xlsx.full.min.js"></script>
<script>if(!window.XLSX){var s=document.createElement('script');s.src='https://cdn.jsdelivr.net/npm/xlsx@0.20.3/dist/xlsx.full.min.js';s.setAttribute('data-sheetjs','1');document.head.appendChild(s);}</script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script type="module" src="./js/main.js"></script>
<script>
(function(){try{
  if(!window.__wd_main_ok__){
    var status=document.getElementById('status');
    if(status){status.innerHTML='<span style="color:#b00">Main script did not finish loading. Check Console for the first error above.</span>';}
    if(window.XLSX){
      fetch('./Defender%20Price%20List.xlsx',{cache:'no-store'}).then(function(r){return r.arrayBuffer();}).then(function(buf){
        var wb=XLSX.read(buf,{type:'array'});var names=Object.keys(wb.Sheets||{});if(!names.length)return;
        var html=XLSX.utils.sheet_to_html(wb.Sheets[names[0]]);
        document.getElementById('sheetContainer').innerHTML=html;
      }).catch(function(){});
    }
  }
}catch(e){} })();
</script>
</body>
</html>
