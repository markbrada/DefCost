<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>
<meta charset="UTF-8">
  <title>DefCost 3.1.0</title>
<link rel="stylesheet" href="./css/style.css">
</head>
<body class="light">
        <h1>DefCost 3.1.0</h1>
<button id="darkModeToggle">Toggle Dark Mode</button>
<div id="quoteBuilderMain" aria-label="Quote Builder" role="region">
  <div id="quoteHeader">
    <div class="quote-header-left">
      <h2 id="qbTitle">Quote Builder</h2>
      <span id="toast"></span>
    </div>
    <div id="quoteActions">
      <button id="clearQuoteBtn" type="button" aria-label="Delete quote">Delete quote</button>
      <button id="addCustomBtn" type="button">Add custom line</button>
      <button id="addSectionBtn" type="button">+ Section</button>
      <button id="importCsvBtn" type="button">Import CSV</button>
      <button id="exportCsvBtn" type="button">Export quote CSV</button>
      <input id="importCsvInput" class="hidden-input" type="file" accept=".csv">
    </div>
  </div>
  <div id="sectionTabsBar">
    <div id="sectionTabs"></div>
  </div>
  <div id="basketContainer">
    <div id="basketSticky">
      <div id="basketStickyHead">
        <table id="basketHead">
          <colgroup>
            <col class="col-handle">
            <col class="col-section">
            <col id="col-item">
            <col class="col-quantity">
            <col class="col-price">
            <col class="col-total">
            <col class="col-actions">
          </colgroup>
          <thead><tr>
            <th class="sort-handle">≡</th><th>Section</th><th>Item</th><th>Quantity</th>
            <th>Price</th>
            <th>Line Total</th><th></th>
          </tr></thead>
        </table>
      </div>
    </div>
    <div id="basketContent">
      <div class="basket-table-area">
      <table id="basketTable">
        <colgroup>
          <col class="col-handle">
          <col class="col-section">
          <col id="col-item">
          <col class="col-quantity">
          <col class="col-price">
          <col class="col-total">
          <col class="col-actions">
        </colgroup>
          <thead><tr>
            <th class="sort-handle">≡</th><th>Section</th><th>Item</th><th>Quantity</th>
            <th>Price</th>
            <th>Line Total</th><th></th>
          </tr></thead>
        <tbody></tbody><tfoot></tfoot>
      </table>
      </div>
    </div>
  </div>
  <div class="grand-totals-wrapper">
    <aside id="grandTotals" aria-live="polite"></aside>
  </div>
</div>
<div id="catalogWindow" aria-label="Catalogue window" role="dialog" aria-modal="false">
  <div id="catalogTitlebar">
    <div id="catalogDots">
      <button id="catalogClose" aria-label="Hide catalogue" title="Hide catalogue"></button>
      <button id="catalogMin" aria-label="Dock window" title="Dock window"></button>
      <button id="catalogZoom" aria-label="Full screen" title="Full screen"></button>
    </div>
    <div id="catalogTitle">Catalogue</div>
  </div>
  <div id="catalogBody">
    <div id="sheetTabs"></div>
    <div id="status" class="status-text"></div>
    <div id="manualLoad" class="manual-load"><label class="search-label">Load workbook:</label><input type="file" id="xlsxPicker" accept=".xlsx"></div>
    <div id="sheetContainer"></div>
  </div>
  <div id="catalogResizeHandle" aria-hidden="true"></div>
</div>
<button id="catalogDockIcon" title="Open catalogue" aria-label="Open catalogue">Catalogue</button>
<script src="xlsx.full.min.js"></script>
<script>if(!window.XLSX){var s=document.createElement('script');s.src='https://cdn.jsdelivr.net/npm/xlsx@0.20.3/dist/xlsx.full.min.js';s.setAttribute('data-sheetjs','1');document.head.appendChild(s);}</script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script type="module" src="./js/main.js"></script>
<script>
(function(){try{
  if(!window.__wd_main_ok__){
    var status=document.getElementById('status');
    if(status){status.innerHTML='<span style="color:#b00">Main script did not finish loading. Check Console for the first error above.</span>';}
    if(window.XLSX){
      fetch('./Defender%20Price%20List.xlsx',{cache:'no-store'}).then(function(r){return r.arrayBuffer();}).then(function(buf){
        var wb=XLSX.read(buf,{type:'array'});var names=Object.keys(wb.Sheets||{});if(!names.length)return;
        var html=XLSX.utils.sheet_to_html(wb.Sheets[names[0]]);
        document.getElementById('sheetContainer').innerHTML=html;
      }).catch(function(){});
    }
  }
}catch(e){} })();
</script>
</body>
</html>
